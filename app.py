from flask import Flask, request
from linebot import LineBotApi, WebhookHandler
from linebot.models import (
    MessageEvent, TextMessage,
    TextSendMessage, ImageSendMessage
)
import os

app = Flask(__name__)

line_bot_api = LineBotApi(os.getenv("LINE_ACCESS_TOKEN"))
handler = WebhookHandler(os.getenv("LINE_CHANNEL_SECRET"))

@app.route("/callback", methods=["POST"])
def callback():
    try:
        signature = request.headers["X-Line-Signature"]
        body = request.get_data(as_text=True)
        handler.handle(body, signature)
    except Exception as e:
        print(e)
    return "OK"

@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    text = event.message.text.strip().lower()
    if not text:
        return

    commands = (
        "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ôkiosk", "‡∏¢‡∏≠‡∏î", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô",
        "‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÉ‡∏ö", "‡∏ö‡∏±‡∏ï‡∏£",
        "wifi", "ci",
        "‡πÄ‡∏ö‡∏≠‡∏£‡πå", "‡πÄ‡∏ö‡∏≠", "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£", "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå",
        "‡∏†‡∏≤‡∏©‡∏µ", "vat",
        "help", "‡∏ö‡∏≠‡∏ó"
    )

    if text not in commands:
        return

    messages = []

    if text in ("help", "‡∏ö‡∏≠‡∏ó"):
        messages.append(TextSendMessage(
            text=(
                "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ:\n"

                "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ôkiosk\n"
                "‡∏¢‡∏≠‡∏î\n"
                "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô\n"
                "‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÉ‡∏ö\n" 
                "‡∏ö‡∏±‡∏ï‡∏£\n"
                "Wifi\n"
                "ci\n"
                "‡πÄ‡∏ö‡∏≠‡∏£‡πå\n"
                "‡∏†‡∏≤‡∏©‡∏µ\n"
                 "vat"
            )
        ))

    elif cmd in ("‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ôkiosk", "‡∏¢‡∏≠‡∏î", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô"):
         reply = (
        "üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏π‡πâ KIOSK\n"
        "https://smartcargo.airportthai.co.th/aotwebmanagement/reports/KisokreportComponent\n\n"
        "User : wanakorn.poa@proinside.co.th\n"
        "Password : 10101010\n\n"
        "‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:\n"
        "‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ A7 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô\n"
        "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏π‡πâ KIOSK\n"
        "‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà 1 ‡∏Å‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà 7\n\n"
        "‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà 1:\n"
        "- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏π‡πâ Kiosk\n"
        "- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏π‡πâ\n"
        "- ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πá‡∏Ñ\n\n"
        "‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà 7:\n"
        "- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô\n"
        "- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏π‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\n"
        "- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ\n\n"
        "‡∏ñ‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4\n"
        "‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô\n"
        "‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ï‡∏π‡πâ"
    )
    elif cmd in ("‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÉ‡∏ö", "‡∏ö‡∏±‡∏ï‡∏£"):
        reply = (
            "üé´ ‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÉ‡∏ö\n"
            "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÉ‡∏ö\n"
            "- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ù‡∏≤‡∏õ‡∏¥‡∏î‡∏™‡∏ô‡∏¥‡∏ó‡πÑ‡∏´‡∏°\n"
            "- ‡∏õ‡∏¥‡∏î‡∏™‡∏ß‡∏¥‡∏ï‡∏ã‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏¥‡πâ‡∏ô\n"
            "- ‡∏•‡∏ö driver ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà 2 ‡∏•‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\n"
            "- Restart Computer\n"
            "- ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏ß‡∏¥‡∏ï‡∏ã‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏¥‡πâ‡∏ô\n"
            "- ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô : ‡πÉ‡∏ä‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á\n"
            "- Set ‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô 80 mm 50 mm 0 mm 0mm ‡∏£‡∏ß‡∏° 4 ‡∏ä‡πà‡∏≠‡∏á\n"
            "- ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡∏™‡∏ú‡πà‡∏≤‡∏ô admin 4 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏Å‡πá‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠ 1 ‡∏Ñ‡∏£‡∏±‡∏ö\n"
            "‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏π‡πâ 01-09 ‡∏ï‡πâ‡∏≠‡∏á Test ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡∏ï‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ 9 ‡∏ï‡∏π‡πâ‡∏ô‡∏µ‡πâ ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏∞‡∏ï‡∏≤‡∏¢"
        )
    elif cmd in ("Wifi", "ci"):
        reply = ("‡∏£‡∏´‡∏±‡∏™  Wifi Ci\n"
         "Pi@FDMS464690")

    elif cmd in ("‡πÄ‡∏ö‡∏≠‡∏£‡πå", "‡πÄ‡∏ö‡∏≠" , "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£", "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå"):
        reply = ("‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏ó‡∏µ‡∏°\n"
        "‡∏Æ‡∏≠‡∏ô 091-568-8414\n"
        "‡πÄ‡∏ö‡πä‡∏ö 061-818-5046\n"
        "‡πÄ‡∏ß‡∏¢‡πå 062-462-5538\n"
        "‡∏ï‡πâ‡∏ô‡∏ï‡∏≤‡∏ß 099-790-7639\n"
        "‡∏ö‡∏≤‡∏™ 082-315-0099\n"
        "‡∏Å‡πä‡∏Å 098-920-0310\n"
        "‡∏î‡∏¥‡∏ü 091-037-5913")

    elif text in ("‡∏†‡∏≤‡∏©‡∏µ", "vat"):
        image_url = "https://github.com/vankokeiei/line-group-bot/blob/main/LINE_NOTE_260101_1.jpg?raw=true"
        messages.append(TextSendMessage(text="üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏†‡∏≤‡∏©‡∏µ"))
        messages.append(ImageSendMessage(
            original_content_url=image_url,
            preview_image_url=image_url
        ))
    else:
        reply = "‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ ‡∏û‡∏¥‡∏°‡∏û‡πå help , ‡∏ö‡∏≠‡∏ó ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ"

    line_bot_api.reply_message(event.reply_token, messages)

if __name__ == "__main__":
    app.run(port=50000)
    